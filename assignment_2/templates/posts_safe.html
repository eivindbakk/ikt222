{% extends "base.html" %}
{% block content %}
<h1>Safe posts (sanitized + escaped + CSP)</h1>
<p>
    This page sanitizes input with <code>bleach</code>, relies on Jinja autoescaping (no <code>|safe</code>),
    and adds a strict Content Security Policy (CSP) to block inline scripts.
</p>
<div>
    {% for p in posts %}
    <div class="post">
        <div class="meta">{{ p.created_at }} — by <strong>{{ p.author }}</strong></div>
        <div class="content">
            <!-- NOT marked safe; Jinja will escape. Allowed tags remain from bleach. -->
            {{ p.content }}
        </div>
    </div>
    {% else %}
    <em>No posts yet.</em>
    {% endfor %}
</div>
{% endblock %}
